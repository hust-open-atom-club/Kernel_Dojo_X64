FW_CFG_PATH="/sys/firmware/qemu_fw_cfg/by_name/opt/guest/flag_content/raw"
DEST_FLAG_PATH="/flag"

if [ -e "$FW_CFG_PATH" ]; then
    cp "$FW_CFG_PATH" "$DEST_FLAG_PATH"

    chown root:root "$DEST_FLAG_PATH"
    chmod 400 "$DEST_FLAG_PATH"

    echo "Guest $DEST_FLAG_PATH created from fw_cfg."
else
    echo "Error: fw_cfg entry for flag not found at $FW_CFG_PATH."
fi
